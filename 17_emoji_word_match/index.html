<!doctype html>
<meta charset="utf-8">
<title>Emoji Word Match v2 â€“ generator</title>

<!-- === size first === -->
<label>W <input id=w type=number value=800 min=100></label>
<label>H <input id=h type=number value=600 min=100></label>

<!-- === 4-digit code + dice === -->
<label>Code <input id=code type=text value=1234 pattern="\d{3,5}" maxlength=5></label>
<button type=button data-t="code">&#x1F3B2;</button>

<hr>

<!-- === creativity controls === -->
<label>Distractor pairs
  <input id=distractors type=range min=0 max=30 value=4>
</label><br>

<label>Emoji size (% of H)
  <input id=emojiSize type=range min=3 max=40 value=20>
</label><br>

<label>Badge size (% of emoji)
  <input id=badgeSize type=range min=20 max=100 value=60>
</label><br>

<label>Rotation (degrees)
  <input id=rotation type=range min=0 max=60 value=10>
</label><br>

<label>Jitter (% of cell)
  <input id=jitter type=range min=0 max=50 value=20>
</label><br>

<label>Emoji category
  <select id=category>
    <option value="all" selected>all</option>
    <option value="animals">animals</option>
    <option value="food">food</option>
    <option value="vehicles">vehicles</option>
    <option value="nature">nature</option>
    <option value="sports">sports</option>
    <option value="objects">objects</option>
  </select>
</label><br>

<label>Language
  <select id=lang>
    <option value="en" selected>EN</option>
    <option value="ru">RU</option>
  </select>
</label><br>

<label>Badge shape
  <select id=badgeShape>
    <option value="circle" selected>circle</option>
    <option value="square">square</option>
    <option value="hexagon">hexagon</option>
    <option value="star">star</option>
    <option value="heart">heart</option>
  </select>
</label><br>

<label>Drop shadow <input id=shadow type=checkbox></label><br>
<label>Shadow blur
  <input id=shadowBlur type=range min=1 max=20 value=6>
</label><br>

<label>Area split (% emoji)
  <input id=areaSplit type=range min=60 max=85 value=75>
</label><br>

<label>Dot mode <input id=dotMode type=checkbox></label><br>

<hr>

<button id=reset type=button>Restore defaults</button>
<button id=rerender type=button>Re-render</button>

<hr>

<canvas id=can title="Click to download" style="border:1px solid grey;cursor:pointer"></canvas>

<script>
/**
 * Curated, child-safe emoji lexicon with bilingual names (EN/RU).
 * 98 emojis across 6 categories: animals, vehicles, food, nature, sports, objects.
 *
 * Ported from mystery-box-generators/src/resources/emoji-lexicon.ts + emojis.ts
 */

const EMOJI_LEXICON = [
  { emoji: '\u{1F436}', category: 'animals', names: { en: { singular: 'dog', count: 'dogs' }, ru: { singular: '\u0441\u043E\u0431\u0430\u043A\u0430', count: '\u0441\u043E\u0431\u0430\u043A' } } },
  { emoji: '\u{1F431}', category: 'animals', names: { en: { singular: 'cat', count: 'cats' }, ru: { singular: '\u043A\u043E\u0448\u043A\u0430', count: '\u043A\u043E\u0448\u0435\u043A' } } },
  { emoji: '\u{1F42D}', category: 'animals', names: { en: { singular: 'mouse', count: 'mice' }, ru: { singular: '\u043C\u044B\u0448\u044C', count: '\u043C\u044B\u0448\u0435\u0439' } } },
  { emoji: '\u{1F439}', category: 'animals', names: { en: { singular: 'hamster', count: 'hamsters' }, ru: { singular: '\u0445\u043E\u043C\u044F\u043A', count: '\u0445\u043E\u043C\u044F\u043A\u043E\u0432' } } },
  { emoji: '\u{1F430}', category: 'animals', names: { en: { singular: 'rabbit', count: 'rabbits' }, ru: { singular: '\u043A\u0440\u043E\u043B\u0438\u043A', count: '\u043A\u0440\u043E\u043B\u0438\u043A\u043E\u0432' } } },
  { emoji: '\u{1F98A}', category: 'animals', names: { en: { singular: 'fox', count: 'foxes' }, ru: { singular: '\u043B\u0438\u0441\u0430', count: '\u043B\u0438\u0441' } } },
  { emoji: '\u{1F43B}', category: 'animals', names: { en: { singular: 'bear', count: 'bears' }, ru: { singular: '\u043C\u0435\u0434\u0432\u0435\u0434\u044C', count: '\u043C\u0435\u0434\u0432\u0435\u0434\u0435\u0439' } } },
  { emoji: '\u{1F43C}', category: 'animals', names: { en: { singular: 'panda', count: 'pandas' }, ru: { singular: '\u043F\u0430\u043D\u0434\u0430', count: '\u043F\u0430\u043D\u0434' } } },
  { emoji: '\u{1F42F}', category: 'animals', names: { en: { singular: 'tiger', count: 'tigers' }, ru: { singular: '\u0442\u0438\u0433\u0440', count: '\u0442\u0438\u0433\u0440\u043E\u0432' } } },
  { emoji: '\u{1F981}', category: 'animals', names: { en: { singular: 'lion', count: 'lions' }, ru: { singular: '\u043B\u0435\u0432', count: '\u043B\u044C\u0432\u043E\u0432' } } },
  { emoji: '\u{1F42E}', category: 'animals', names: { en: { singular: 'cow', count: 'cows' }, ru: { singular: '\u043A\u043E\u0440\u043E\u0432\u0430', count: '\u043A\u043E\u0440\u043E\u0432' } } },
  { emoji: '\u{1F438}', category: 'animals', names: { en: { singular: 'frog', count: 'frogs' }, ru: { singular: '\u043B\u044F\u0433\u0443\u0448\u043A\u0430', count: '\u043B\u044F\u0433\u0443\u0448\u0435\u043A' } } },
  { emoji: '\u{1F435}', category: 'animals', names: { en: { singular: 'monkey', count: 'monkeys' }, ru: { singular: '\u043E\u0431\u0435\u0437\u044C\u044F\u043D\u0430', count: '\u043E\u0431\u0435\u0437\u044C\u044F\u043D' } } },
  { emoji: '\u{1F414}', category: 'animals', names: { en: { singular: 'chicken', count: 'chickens' }, ru: { singular: '\u043A\u0443\u0440\u0438\u0446\u0430', count: '\u043A\u0443\u0440\u0438\u0446' } } },
  { emoji: '\u{1F427}', category: 'animals', names: { en: { singular: 'penguin', count: 'penguins' }, ru: { singular: '\u043F\u0438\u043D\u0433\u0432\u0438\u043D', count: '\u043F\u0438\u043D\u0433\u0432\u0438\u043D\u043E\u0432' } } },
  { emoji: '\u{1F986}', category: 'animals', names: { en: { singular: 'duck', count: 'ducks' }, ru: { singular: '\u0443\u0442\u043A\u0430', count: '\u0443\u0442\u043E\u043A' } } },
  { emoji: '\u{1F989}', category: 'animals', names: { en: { singular: 'owl', count: 'owls' }, ru: { singular: '\u0441\u043E\u0432\u0430', count: '\u0441\u043E\u0432' } } },
  { emoji: '\u{1F984}', category: 'animals', names: { en: { singular: 'unicorn', count: 'unicorns' }, ru: { singular: '\u0435\u0434\u0438\u043D\u043E\u0440\u043E\u0433', count: '\u0435\u0434\u0438\u043D\u043E\u0440\u043E\u0433\u043E\u0432' } } },
  { emoji: '\u{1F422}', category: 'animals', names: { en: { singular: 'turtle', count: 'turtles' }, ru: { singular: '\u0447\u0435\u0440\u0435\u043F\u0430\u0445\u0430', count: '\u0447\u0435\u0440\u0435\u043F\u0430\u0445' } } },
  { emoji: '\u{1F419}', category: 'animals', names: { en: { singular: 'octopus', count: 'octopuses' }, ru: { singular: '\u043E\u0441\u044C\u043C\u0438\u043D\u043E\u0433', count: '\u043E\u0441\u044C\u043C\u0438\u043D\u043E\u0433\u043E\u0432' } } },
  { emoji: '\u{1F98B}', category: 'animals', names: { en: { singular: 'butterfly', count: 'butterflies' }, ru: { singular: '\u0431\u0430\u0431\u043E\u0447\u043A\u0430', count: '\u0431\u0430\u0431\u043E\u0447\u0435\u043A' } } },
  { emoji: '\u{1F41D}', category: 'animals', names: { en: { singular: 'bee', count: 'bees' }, ru: { singular: '\u043F\u0447\u0435\u043B\u0430', count: '\u043F\u0447\u0451\u043B' } } },
  { emoji: '\u{1F40C}', category: 'animals', names: { en: { singular: 'snail', count: 'snails' }, ru: { singular: '\u0443\u043B\u0438\u0442\u043A\u0430', count: '\u0443\u043B\u0438\u0442\u043E\u043A' } } },
  { emoji: '\u{1F420}', category: 'animals', names: { en: { singular: 'fish', count: 'fish' }, ru: { singular: '\u0440\u044B\u0431\u0430', count: '\u0440\u044B\u0431' } } },

  { emoji: '\u{1F697}', category: 'vehicles', names: { en: { singular: 'car', count: 'cars' }, ru: { singular: '\u043C\u0430\u0448\u0438\u043D\u0430', count: '\u043C\u0430\u0448\u0438\u043D' } } },
  { emoji: '\u{1F68C}', category: 'vehicles', names: { en: { singular: 'bus', count: 'buses' }, ru: { singular: '\u0430\u0432\u0442\u043E\u0431\u0443\u0441', count: '\u0430\u0432\u0442\u043E\u0431\u0443\u0441\u043E\u0432' } } },
  { emoji: '\u{1F69C}', category: 'vehicles', names: { en: { singular: 'tractor', count: 'tractors' }, ru: { singular: '\u0442\u0440\u0430\u043A\u0442\u043E\u0440', count: '\u0442\u0440\u0430\u043A\u0442\u043E\u0440\u043E\u0432' } } },
  { emoji: '\u{1F6B2}', category: 'vehicles', names: { en: { singular: 'bicycle', count: 'bicycles' }, ru: { singular: '\u0432\u0435\u043B\u043E\u0441\u0438\u043F\u0435\u0434', count: '\u0432\u0435\u043B\u043E\u0441\u0438\u043F\u0435\u0434\u043E\u0432' } } },
  { emoji: '\u{1F686}', category: 'vehicles', names: { en: { singular: 'train', count: 'trains' }, ru: { singular: '\u043F\u043E\u0435\u0437\u0434', count: '\u043F\u043E\u0435\u0437\u0434\u043E\u0432' } } },
  { emoji: '\u{1F681}', category: 'vehicles', names: { en: { singular: 'helicopter', count: 'helicopters' }, ru: { singular: '\u0432\u0435\u0440\u0442\u043E\u043B\u0451\u0442', count: '\u0432\u0435\u0440\u0442\u043E\u043B\u0451\u0442\u043E\u0432' } } },
  { emoji: '\u26F5', category: 'vehicles', names: { en: { singular: 'sailboat', count: 'sailboats' }, ru: { singular: '\u043F\u0430\u0440\u0443\u0441\u043D\u0438\u043A', count: '\u043F\u0430\u0440\u0443\u0441\u043D\u0438\u043A\u043E\u0432' } } },
  { emoji: '\u{1F680}', category: 'vehicles', names: { en: { singular: 'rocket', count: 'rockets' }, ru: { singular: '\u0440\u0430\u043A\u0435\u0442\u0430', count: '\u0440\u0430\u043A\u0435\u0442' } } },
  { emoji: '\u{1F695}', category: 'vehicles', names: { en: { singular: 'taxi', count: 'taxis' }, ru: { singular: '\u0442\u0430\u043A\u0441\u0438', count: '\u0442\u0430\u043A\u0441\u0438' } } },
  { emoji: '\u{1F699}', category: 'vehicles', names: { en: { singular: 'SUV', count: 'SUVs' }, ru: { singular: '\u0432\u043D\u0435\u0434\u043E\u0440\u043E\u0436\u043D\u0438\u043A', count: '\u0432\u043D\u0435\u0434\u043E\u0440\u043E\u0436\u043D\u0438\u043A\u043E\u0432' } } },

  { emoji: '\u{1F34E}', category: 'food', names: { en: { singular: 'apple', count: 'apples' }, ru: { singular: '\u044F\u0431\u043B\u043E\u043A\u043E', count: '\u044F\u0431\u043B\u043E\u043A' } } },
  { emoji: '\u{1F350}', category: 'food', names: { en: { singular: 'pear', count: 'pears' }, ru: { singular: '\u0433\u0440\u0443\u0448\u0430', count: '\u0433\u0440\u0443\u0448' } } },
  { emoji: '\u{1F34A}', category: 'food', names: { en: { singular: 'orange', count: 'oranges' }, ru: { singular: '\u0430\u043F\u0435\u043B\u044C\u0441\u0438\u043D', count: '\u0430\u043F\u0435\u043B\u044C\u0441\u0438\u043D\u043E\u0432' } } },
  { emoji: '\u{1F34B}', category: 'food', names: { en: { singular: 'lemon', count: 'lemons' }, ru: { singular: '\u043B\u0438\u043C\u043E\u043D', count: '\u043B\u0438\u043C\u043E\u043D\u043E\u0432' } } },
  { emoji: '\u{1F34C}', category: 'food', names: { en: { singular: 'banana', count: 'bananas' }, ru: { singular: '\u0431\u0430\u043D\u0430\u043D', count: '\u0431\u0430\u043D\u0430\u043D\u043E\u0432' } } },
  { emoji: '\u{1F349}', category: 'food', names: { en: { singular: 'watermelon', count: 'watermelons' }, ru: { singular: '\u0430\u0440\u0431\u0443\u0437', count: '\u0430\u0440\u0431\u0443\u0437\u043E\u0432' } } },
  { emoji: '\u{1F347}', category: 'food', names: { en: { singular: 'grape', count: 'grapes' }, ru: { singular: '\u0432\u0438\u043D\u043E\u0433\u0440\u0430\u0434\u0438\u043D\u0430', count: '\u0432\u0438\u043D\u043E\u0433\u0440\u0430\u0434\u0438\u043D' } } },
  { emoji: '\u{1F353}', category: 'food', names: { en: { singular: 'strawberry', count: 'strawberries' }, ru: { singular: '\u043A\u043B\u0443\u0431\u043D\u0438\u043A\u0430', count: '\u043A\u043B\u0443\u0431\u043D\u0438\u043A' } } },
  { emoji: '\u{1F352}', category: 'food', names: { en: { singular: 'cherry', count: 'cherries' }, ru: { singular: '\u0432\u0438\u0448\u043D\u044F', count: '\u0432\u0438\u0448\u0435\u043D' } } },
  { emoji: '\u{1F34D}', category: 'food', names: { en: { singular: 'pineapple', count: 'pineapples' }, ru: { singular: '\u0430\u043D\u0430\u043D\u0430\u0441', count: '\u0430\u043D\u0430\u043D\u0430\u0441\u043E\u0432' } } },
  { emoji: '\u{1F95D}', category: 'food', names: { en: { singular: 'kiwi', count: 'kiwis' }, ru: { singular: '\u043A\u0438\u0432\u0438', count: '\u043A\u0438\u0432\u0438' } } },
  { emoji: '\u{1F955}', category: 'food', names: { en: { singular: 'carrot', count: 'carrots' }, ru: { singular: '\u043C\u043E\u0440\u043A\u043E\u0432\u043A\u0430', count: '\u043C\u043E\u0440\u043A\u043E\u0432\u043E\u043A' } } },
  { emoji: '\u{1F33D}', category: 'food', names: { en: { singular: 'corn cob', count: 'corn cobs' }, ru: { singular: '\u043F\u043E\u0447\u0430\u0442\u043E\u043A \u043A\u0443\u043A\u0443\u0440\u0443\u0437\u044B', count: '\u043F\u043E\u0447\u0430\u0442\u043A\u043E\u0432 \u043A\u0443\u043A\u0443\u0440\u0443\u0437\u044B' } } },
  { emoji: '\u{1F345}', category: 'food', names: { en: { singular: 'tomato', count: 'tomatoes' }, ru: { singular: '\u043F\u043E\u043C\u0438\u0434\u043E\u0440', count: '\u043F\u043E\u043C\u0438\u0434\u043E\u0440\u043E\u0432' } } },
  { emoji: '\u{1F954}', category: 'food', names: { en: { singular: 'potato', count: 'potatoes' }, ru: { singular: '\u043A\u0430\u0440\u0442\u043E\u0444\u0435\u043B\u0438\u043D\u0430', count: '\u043A\u0430\u0440\u0442\u043E\u0444\u0435\u043B\u0438\u043D' } } },
  { emoji: '\u{1F966}', category: 'food', names: { en: { singular: 'broccoli', count: 'broccoli' }, ru: { singular: '\u0431\u0440\u043E\u043A\u043A\u043E\u043B\u0438', count: '\u0431\u0440\u043E\u043A\u043A\u043E\u043B\u0438' } } },
  { emoji: '\u{1F952}', category: 'food', names: { en: { singular: 'cucumber', count: 'cucumbers' }, ru: { singular: '\u043E\u0433\u0443\u0440\u0435\u0446', count: '\u043E\u0433\u0443\u0440\u0446\u043E\u0432' } } },
  { emoji: '\u{1F355}', category: 'food', names: { en: { singular: 'pizza', count: 'pizzas' }, ru: { singular: '\u043F\u0438\u0446\u0446\u0430', count: '\u043F\u0438\u0446\u0446' } } },
  { emoji: '\u{1F354}', category: 'food', names: { en: { singular: 'burger', count: 'burgers' }, ru: { singular: '\u0431\u0443\u0440\u0433\u0435\u0440', count: '\u0431\u0443\u0440\u0433\u0435\u0440\u043E\u0432' } } },
  { emoji: '\u{1F35F}', category: 'food', names: { en: { singular: 'fries', count: 'fries' }, ru: { singular: '\u043A\u0430\u0440\u0442\u043E\u0448\u043A\u0430 \u0444\u0440\u0438', count: '\u043F\u043E\u0440\u0446\u0438\u0439 \u043A\u0430\u0440\u0442\u043E\u0448\u043A\u0438 \u0444\u0440\u0438' } } },
  { emoji: '\u{1F32D}', category: 'food', names: { en: { singular: 'hot dog', count: 'hot dogs' }, ru: { singular: '\u0445\u043E\u0442-\u0434\u043E\u0433', count: '\u0445\u043E\u0442-\u0434\u043E\u0433\u043E\u0432' } } },
  { emoji: '\u{1F32E}', category: 'food', names: { en: { singular: 'taco', count: 'tacos' }, ru: { singular: '\u0442\u0430\u043A\u043E', count: '\u0442\u0430\u043A\u043E' } } },
  { emoji: '\u{1F32F}', category: 'food', names: { en: { singular: 'burrito', count: 'burritos' }, ru: { singular: '\u0431\u0443\u0440\u0440\u0438\u0442\u043E', count: '\u0431\u0443\u0440\u0440\u0438\u0442\u043E' } } },
  { emoji: '\u{1F37F}', category: 'food', names: { en: { singular: 'popcorn', count: 'popcorn buckets' }, ru: { singular: '\u043F\u043E\u043F\u043A\u043E\u0440\u043D', count: '\u0432\u0451\u0434\u0435\u0440 \u043F\u043E\u043F\u043A\u043E\u0440\u043D\u0430' } } },
  { emoji: '\u{1F36A}', category: 'food', names: { en: { singular: 'cookie', count: 'cookies' }, ru: { singular: '\u043F\u0435\u0447\u0435\u043D\u044C\u043A\u0430', count: '\u043F\u0435\u0447\u0435\u043D\u0435\u043A' } } },
  { emoji: '\u{1F369}', category: 'food', names: { en: { singular: 'donut', count: 'donuts' }, ru: { singular: '\u043F\u043E\u043D\u0447\u0438\u043A', count: '\u043F\u043E\u043D\u0447\u0438\u043A\u043E\u0432' } } },
  { emoji: '\u{1F9C1}', category: 'food', names: { en: { singular: 'cupcake', count: 'cupcakes' }, ru: { singular: '\u043A\u0430\u043F\u043A\u0435\u0439\u043A', count: '\u043A\u0430\u043F\u043A\u0435\u0439\u043A\u043E\u0432' } } },
  { emoji: '\u{1F370}', category: 'food', names: { en: { singular: 'cake', count: 'cakes' }, ru: { singular: '\u0442\u043E\u0440\u0442', count: '\u0442\u043E\u0440\u0442\u043E\u0432' } } },
  { emoji: '\u{1F36B}', category: 'food', names: { en: { singular: 'chocolate bar', count: 'chocolate bars' }, ru: { singular: '\u0448\u043E\u043A\u043E\u043B\u0430\u0434\u043A\u0430', count: '\u0448\u043E\u043A\u043E\u043B\u0430\u0434\u043E\u043A' } } },
  { emoji: '\u{1F36D}', category: 'food', names: { en: { singular: 'lollipop', count: 'lollipops' }, ru: { singular: '\u043B\u0435\u0434\u0435\u043D\u0435\u0446', count: '\u043B\u0435\u0434\u0435\u043D\u0446\u043E\u0432' } } },
  { emoji: '\u{1F368}', category: 'food', names: { en: { singular: 'ice cream', count: 'ice creams' }, ru: { singular: '\u043C\u043E\u0440\u043E\u0436\u0435\u043D\u043E\u0435', count: '\u043F\u043E\u0440\u0446\u0438\u0439 \u043C\u043E\u0440\u043E\u0436\u0435\u043D\u043E\u0433\u043E' } } },

  { emoji: '\u{1F338}', category: 'nature', names: { en: { singular: 'flower', count: 'flowers' }, ru: { singular: '\u0446\u0432\u0435\u0442\u043E\u043A', count: '\u0446\u0432\u0435\u0442\u043E\u0432' } } },
  { emoji: '\u{1F340}', category: 'nature', names: { en: { singular: 'clover', count: 'clovers' }, ru: { singular: '\u043A\u043B\u0435\u0432\u0435\u0440', count: '\u043A\u043B\u0435\u0432\u0435\u0440\u043E\u0432' } } },
  { emoji: '\u{1F334}', category: 'nature', names: { en: { singular: 'palm tree', count: 'palm trees' }, ru: { singular: '\u043F\u0430\u043B\u044C\u043C\u0430', count: '\u043F\u0430\u043B\u044C\u043C' } } },
  { emoji: '\u{1F335}', category: 'nature', names: { en: { singular: 'cactus', count: 'cactuses' }, ru: { singular: '\u043A\u0430\u043A\u0442\u0443\u0441', count: '\u043A\u0430\u043A\u0442\u0443\u0441\u043E\u0432' } } },
  { emoji: '\u{1F308}', category: 'nature', names: { en: { singular: 'rainbow', count: 'rainbows' }, ru: { singular: '\u0440\u0430\u0434\u0443\u0433\u0430', count: '\u0440\u0430\u0434\u0443\u0433' } } },
  { emoji: '\u{1F319}', category: 'nature', names: { en: { singular: 'moon', count: 'moons' }, ru: { singular: '\u043B\u0443\u043D\u0430', count: '\u043B\u0443\u043D' } } },
  { emoji: '\u{1F31E}', category: 'nature', names: { en: { singular: 'sun', count: 'suns' }, ru: { singular: '\u0441\u043E\u043B\u043D\u0446\u0435', count: '\u0441\u043E\u043B\u043D\u0446' } } },
  { emoji: '\u{1F30A}', category: 'nature', names: { en: { singular: 'wave', count: 'waves' }, ru: { singular: '\u0432\u043E\u043B\u043D\u0430', count: '\u0432\u043E\u043B\u043D' } } },

  { emoji: '\u{1F3C0}', category: 'sports', names: { en: { singular: 'basketball', count: 'basketballs' }, ru: { singular: '\u0431\u0430\u0441\u043A\u0435\u0442\u0431\u043E\u043B\u044C\u043D\u044B\u0439 \u043C\u044F\u0447', count: '\u0431\u0430\u0441\u043A\u0435\u0442\u0431\u043E\u043B\u044C\u043D\u044B\u0445 \u043C\u044F\u0447\u0435\u0439' } } },
  { emoji: '\u{1F3BE}', category: 'sports', names: { en: { singular: 'tennis ball', count: 'tennis balls' }, ru: { singular: '\u0442\u0435\u043D\u043D\u0438\u0441\u043D\u044B\u0439 \u043C\u044F\u0447', count: '\u0442\u0435\u043D\u043D\u0438\u0441\u043D\u044B\u0445 \u043C\u044F\u0447\u0435\u0439' } } },
  { emoji: '\u{1F3D0}', category: 'sports', names: { en: { singular: 'volleyball', count: 'volleyballs' }, ru: { singular: '\u0432\u043E\u043B\u0435\u0439\u0431\u043E\u043B\u044C\u043D\u044B\u0439 \u043C\u044F\u0447', count: '\u0432\u043E\u043B\u0435\u0439\u0431\u043E\u043B\u044C\u043D\u044B\u0445 \u043C\u044F\u0447\u0435\u0439' } } },
  { emoji: '\u{1F3C2}', category: 'sports', names: { en: { singular: 'snowboarder', count: 'snowboarders' }, ru: { singular: '\u0441\u043D\u043E\u0443\u0431\u043E\u0440\u0434\u0438\u0441\u0442', count: '\u0441\u043D\u043E\u0443\u0431\u043E\u0440\u0434\u0438\u0441\u0442\u043E\u0432' } } },
  { emoji: '\u{1F6F9}', category: 'sports', names: { en: { singular: 'skateboard', count: 'skateboards' }, ru: { singular: '\u0441\u043A\u0435\u0439\u0442\u0431\u043E\u0440\u0434', count: '\u0441\u043A\u0435\u0439\u0442\u0431\u043E\u0440\u0434\u043E\u0432' } } },
  { emoji: '\u{1F3AF}', category: 'sports', names: { en: { singular: 'target', count: 'targets' }, ru: { singular: '\u043C\u0438\u0448\u0435\u043D\u044C', count: '\u043C\u0438\u0448\u0435\u043D\u0435\u0439' } } },
  { emoji: '\u{1F3C6}', category: 'sports', names: { en: { singular: 'trophy', count: 'trophies' }, ru: { singular: '\u043A\u0443\u0431\u043E\u043A', count: '\u043A\u0443\u0431\u043A\u043E\u0432' } } },

  { emoji: '\u{1F381}', category: 'objects', names: { en: { singular: 'gift', count: 'gifts' }, ru: { singular: '\u043F\u043E\u0434\u0430\u0440\u043E\u043A', count: '\u043F\u043E\u0434\u0430\u0440\u043A\u043E\u0432' } } },
  { emoji: '\u{1F388}', category: 'objects', names: { en: { singular: 'balloon', count: 'balloons' }, ru: { singular: '\u0448\u0430\u0440\u0438\u043A', count: '\u0448\u0430\u0440\u0438\u043A\u043E\u0432' } } },
  { emoji: '\u{1F9F8}', category: 'objects', names: { en: { singular: 'teddy bear', count: 'teddy bears' }, ru: { singular: '\u043F\u043B\u044E\u0448\u0435\u0432\u044B\u0439 \u043C\u0438\u0448\u043A\u0430', count: '\u043F\u043B\u044E\u0448\u0435\u0432\u044B\u0445 \u043C\u0438\u0448\u0435\u043A' } } },
  { emoji: '\u{1F4D8}', category: 'objects', names: { en: { singular: 'book', count: 'books' }, ru: { singular: '\u043A\u043D\u0438\u0433\u0430', count: '\u043A\u043D\u0438\u0433' } } },
  { emoji: '\u{1F4CF}', category: 'objects', names: { en: { singular: 'ruler', count: 'rulers' }, ru: { singular: '\u043B\u0438\u043D\u0435\u0439\u043A\u0430', count: '\u043B\u0438\u043D\u0435\u0435\u043A' } } },
  { emoji: '\u{1F4CE}', category: 'objects', names: { en: { singular: 'paperclip', count: 'paperclips' }, ru: { singular: '\u0441\u043A\u0440\u0435\u043F\u043A\u0430', count: '\u0441\u043A\u0440\u0435\u043F\u043E\u043A' } } },
  { emoji: '\u{1F50D}', category: 'objects', names: { en: { singular: 'magnifying glass', count: 'magnifying glasses' }, ru: { singular: '\u043B\u0443\u043F\u0430', count: '\u043B\u0443\u043F' } } },
  { emoji: '\u{1F512}', category: 'objects', names: { en: { singular: 'lock', count: 'locks' }, ru: { singular: '\u0437\u0430\u043C\u043E\u043A', count: '\u0437\u0430\u043C\u043A\u043E\u0432' } } },
  { emoji: '\u23F0', category: 'objects', names: { en: { singular: 'alarm clock', count: 'alarm clocks' }, ru: { singular: '\u0431\u0443\u0434\u0438\u043B\u044C\u043D\u0438\u043A', count: '\u0431\u0443\u0434\u0438\u043B\u044C\u043D\u0438\u043A\u043E\u0432' } } },
  { emoji: '\u{1F9ED}', category: 'objects', names: { en: { singular: 'compass', count: 'compasses' }, ru: { singular: '\u043A\u043E\u043C\u043F\u0430\u0441', count: '\u043A\u043E\u043C\u043F\u0430\u0441\u043E\u0432' } } },
  { emoji: '\u{1F511}', category: 'objects', names: { en: { singular: 'key', count: 'keys' }, ru: { singular: '\u043A\u043B\u044E\u0447', count: '\u043A\u043B\u044E\u0447\u0435\u0439' } } },
  { emoji: '\u{1F4DD}', category: 'objects', names: { en: { singular: 'memo', count: 'memos' }, ru: { singular: '\u0437\u0430\u043F\u0438\u0441\u043A\u0430', count: '\u0437\u0430\u043F\u0438\u0441\u043E\u043A' } } },
];

const EMOJI_CATEGORY_NAMES = ['animals', 'vehicles', 'food', 'nature', 'sports', 'objects'];

const EMOJI_CATEGORIES = {};
for (const cat of EMOJI_CATEGORY_NAMES) {
  EMOJI_CATEGORIES[cat] = EMOJI_LEXICON.filter(e => e.category === cat).map(e => e.emoji);
}

const ALL_EMOJIS = EMOJI_LEXICON.map(e => e.emoji);

const getEmojiEntry = (emoji) => EMOJI_LEXICON.find(e => e.emoji === emoji);

const getEmojiName = (emoji, lang = 'en', form = 'singular') => {
  const entry = getEmojiEntry(emoji);
  if (!entry) return emoji;
  const localized = entry.names[lang] || entry.names.en;
  return localized[form] || entry.names.en[form];
};

const getEmojiPool = (category) => {
  if (!category || category === 'all') return ALL_EMOJIS.slice();
  return (EMOJI_CATEGORIES[category] || []).slice();
};

const pickDistinctEmojis = (n, category) => {
  const pool = getEmojiPool(category);
  for (let i = pool.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [pool[i], pool[j]] = [pool[j], pool[i]];
  }
  return pool.slice(0, Math.max(0, Math.min(n, pool.length)));
};
</script>

<script>
// Display current value next to range inputs
document.querySelectorAll('input[type=range]').forEach(r => {
  const span = document.createElement('span');
  span.style.cssText = 'margin-left:1px;font-size:12px;color:#666';
  span.textContent = r.value;
  r.after(span);
  r.addEventListener('input', () => span.textContent = r.value);
});
</script>

<script>
const $ = id => document.getElementById(id);
const ctx = $('can').getContext('2d');
const NAME = 'emoji_word_match_v2';

const DEF = {
  w: 800, h: 600, code: '1234',
  distractors: 4, emojiSize: 20, badgeSize: 60,
  rotation: 10, jitter: 20, category: 'all', lang: 'en',
  badgeShape: 'circle', shadow: false, shadowBlur: 6,
  areaSplit: 75, dotMode: false
};

const BADGE_COLORS = ['#E53935', '#1E88E5', '#43A047', '#FB8C00', '#8E24AA', '#00ACC1'];
const CIRCLED_NUMS = ['\u2460', '\u2461', '\u2462', '\u2463', '\u2464', '\u2465', '\u2466', '\u2467', '\u2468', '\u2469'];

function shuffle(arr) {
  const a = arr.slice();
  for (let i = a.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [a[i], a[j]] = [a[j], a[i]];
  }
  return a;
}

// Dot patterns for die face mode (digits 0-9)
const DOT_PATTERNS = {
  0: [],
  1: [[0, 0]],
  2: [[-0.45, -0.45], [0.45, 0.45]],
  3: [[-0.45, -0.45], [0, 0], [0.45, 0.45]],
  4: [[-0.45, -0.45], [0.45, -0.45], [-0.45, 0.45], [0.45, 0.45]],
  5: [[-0.45, -0.45], [0.45, -0.45], [0, 0], [-0.45, 0.45], [0.45, 0.45]],
  6: [[-0.45, -0.5], [-0.45, 0], [-0.45, 0.5], [0.45, -0.5], [0.45, 0], [0.45, 0.5]],
  7: [[-0.45, -0.5], [-0.45, 0], [-0.45, 0.5], [0, 0], [0.45, -0.5], [0.45, 0], [0.45, 0.5]],
  8: [[-0.45, -0.5], [-0.45, 0], [-0.45, 0.5], [0, -0.5], [0, 0.5], [0.45, -0.5], [0.45, 0], [0.45, 0.5]],
  9: [[-0.45, -0.5], [-0.45, 0], [-0.45, 0.5], [0, -0.5], [0, 0], [0, 0.5], [0.45, -0.5], [0.45, 0], [0.45, 0.5]]
};

// Badge shape drawing functions
function drawBadgeShape(shape, bx, by, r) {
  ctx.beginPath();
  switch (shape) {
    case 'circle':
      ctx.arc(bx, by, r, 0, Math.PI * 2);
      break;
    case 'square':
      ctx.rect(bx - r, by - r, r * 2, r * 2);
      break;
    case 'hexagon': {
      for (let i = 0; i < 6; i++) {
        const angle = (Math.PI / 3) * i - Math.PI / 2;
        const px = bx + r * Math.cos(angle);
        const py = by + r * Math.sin(angle);
        if (i === 0) ctx.moveTo(px, py);
        else ctx.lineTo(px, py);
      }
      ctx.closePath();
      break;
    }
    case 'star': {
      const outerR = r;
      const innerR = r * 0.45;
      for (let i = 0; i < 10; i++) {
        const angle = (Math.PI / 5) * i - Math.PI / 2;
        const rad = i % 2 === 0 ? outerR : innerR;
        const px = bx + rad * Math.cos(angle);
        const py = by + rad * Math.sin(angle);
        if (i === 0) ctx.moveTo(px, py);
        else ctx.lineTo(px, py);
      }
      ctx.closePath();
      break;
    }
    case 'heart': {
      const topY = by - r * 0.4;
      ctx.moveTo(bx, by + r * 0.75);
      ctx.bezierCurveTo(bx - r * 1.3, by - r * 0.1, bx - r * 0.7, topY - r * 0.8, bx, topY);
      ctx.bezierCurveTo(bx + r * 0.7, topY - r * 0.8, bx + r * 1.3, by - r * 0.1, bx, by + r * 0.75);
      ctx.closePath();
      break;
    }
    default:
      ctx.arc(bx, by, r, 0, Math.PI * 2);
      break;
  }
}

function drawDotPattern(digit, bx, by, badgeR) {
  const pattern = DOT_PATTERNS[digit] || [];
  const dotR = badgeR * 0.12;
  ctx.fillStyle = '#fff';
  for (const [ox, oy] of pattern) {
    ctx.beginPath();
    ctx.arc(bx + ox * badgeR, by + oy * badgeR, dotR, 0, Math.PI * 2);
    ctx.fill();
  }
}

// State
let sceneItems = []; // {emoji, digit, x, y, angle, isAnswer}
let wordBoxes = [];  // {word, position, emoji}

function regenerate() {
  const codeStr = $('code').value || '1234';
  const digits = codeStr.split('').map(Number);
  const N = digits.length;
  const M = +$('distractors').value;
  const cat = $('category').value;
  const lang = $('lang').value;

  // Pick N+M distinct emojis
  const allPicked = pickDistinctEmojis(N + M, cat);
  const answerEmojis = allPicked.slice(0, N);
  const distractorEmojis = allPicked.slice(N, N + M);

  // Build scene items
  const items = [];

  // Answer items: emoji with its code digit
  for (let i = 0; i < N; i++) {
    items.push({
      emoji: answerEmojis[i],
      digit: digits[i],
      isAnswer: true
    });
  }

  // Distractor items: emoji with random digit 0-9
  for (let i = 0; i < distractorEmojis.length; i++) {
    items.push({
      emoji: distractorEmojis[i],
      digit: Math.floor(Math.random() * 10),
      isAnswer: false
    });
  }

  // Shuffle all items for placement
  const shuffled = shuffle(items);

  // Compute grid positions with jitter
  const W = +$('w').value, H = +$('h').value;
  const splitPct = +$('areaSplit').value / 100;
  const mainH = H * splitPct;
  const jitterPct = +$('jitter').value / 100;
  const rotMax = +$('rotation').value;
  const total = shuffled.length;

  // Determine grid dimensions
  const aspect = W / mainH;
  let cols = Math.ceil(Math.sqrt(total * aspect));
  let rows = Math.ceil(total / cols);

  const cellW = W / cols;
  const cellH = mainH / rows;

  for (let i = 0; i < shuffled.length; i++) {
    const col = i % cols;
    const row = Math.floor(i / cols);
    const cx = cellW * (col + 0.5);
    const cy = cellH * (row + 0.5);
    const jx = (Math.random() - 0.5) * cellW * jitterPct;
    const jy = (Math.random() - 0.5) * cellH * jitterPct;
    const angle = (Math.random() - 0.5) * 2 * rotMax * Math.PI / 180;

    shuffled[i].x = cx + jx;
    shuffled[i].y = cy + jy;
    shuffled[i].angle = angle;
  }

  sceneItems = shuffled;

  // Word boxes: answer emojis in code order
  wordBoxes = [];
  for (let i = 0; i < N; i++) {
    wordBoxes.push({
      word: getEmojiName(answerEmojis[i], lang, 'singular'),
      position: i,
      emoji: answerEmojis[i]
    });
  }
}

function roundedRect(x, y, w, h, r) {
  ctx.beginPath();
  ctx.moveTo(x + r, y);
  ctx.lineTo(x + w - r, y);
  ctx.quadraticCurveTo(x + w, y, x + w, y + r);
  ctx.lineTo(x + w, y + h - r);
  ctx.quadraticCurveTo(x + w, y + h, x + w - r, y + h);
  ctx.lineTo(x + r, y + h);
  ctx.quadraticCurveTo(x, y + h, x, y + h - r);
  ctx.lineTo(x, y + r);
  ctx.quadraticCurveTo(x, y, x + r, y);
  ctx.closePath();
}

function draw() {
  const W = +$('w').value, H = +$('h').value;
  $('can').width = W; $('can').height = H;
  ctx.fillStyle = '#fff';
  ctx.fillRect(0, 0, W, H);

  const emojiSizePct = +$('emojiSize').value / 100;
  const emojiPx = H * emojiSizePct;
  const badgePct = +$('badgeSize').value / 100;
  const badgeR = emojiPx * badgePct * 0.5;
  const useDotMode = $('dotMode').checked;
  const badgeShape = $('badgeShape').value;
  const shadowOn = $('shadow').checked;
  const shadowBlurVal = +$('shadowBlur').value;

  const splitPct = +$('areaSplit').value / 100;
  const mainH = H * splitPct;
  const bottomH = H * (1 - splitPct);
  const bottomY = mainH;

  // Draw main area emojis
  ctx.textBaseline = 'middle';
  ctx.textAlign = 'center';

  for (const item of sceneItems) {
    ctx.save();
    ctx.translate(item.x, item.y);
    ctx.rotate(item.angle);

    // Apply drop shadow if enabled
    if (shadowOn) {
      ctx.shadowColor = 'rgba(0,0,0,0.3)';
      ctx.shadowBlur = shadowBlurVal;
      ctx.shadowOffsetX = 3;
      ctx.shadowOffsetY = 3;
    }

    // Draw emoji
    ctx.font = emojiPx + 'px sans-serif';
    ctx.fillText(item.emoji, 0, 0);

    // Reset shadow before drawing badge
    ctx.shadowColor = 'transparent';
    ctx.shadowBlur = 0;
    ctx.shadowOffsetX = 0;
    ctx.shadowOffsetY = 0;

    // Draw badge at top-right of emoji
    const bx = emojiPx * 0.4;
    const by = -emojiPx * 0.35;
    const badgeColor = BADGE_COLORS[(sceneItems.indexOf(item)) % BADGE_COLORS.length];

    drawBadgeShape(badgeShape, bx, by, badgeR);
    ctx.fillStyle = badgeColor;
    ctx.fill();
    ctx.strokeStyle = '#fff';
    ctx.lineWidth = Math.max(1, badgeR * 0.15);
    ctx.stroke();

    // Digit in badge (numeral or dot pattern)
    if (useDotMode) {
      drawDotPattern(item.digit, bx, by, badgeR);
    } else {
      ctx.fillStyle = '#fff';
      ctx.font = 'bold ' + (badgeR * 1.3) + 'px sans-serif';
      ctx.textBaseline = 'middle';
      ctx.textAlign = 'center';
      ctx.fillText(item.digit.toString(), bx, by);
    }

    ctx.restore();
  }

  // Draw separator line
  ctx.beginPath();
  ctx.moveTo(W * 0.03, bottomY);
  ctx.lineTo(W * 0.97, bottomY);
  ctx.strokeStyle = '#ccc';
  ctx.lineWidth = 1;
  ctx.stroke();

  // Draw bottom word boxes
  const N = wordBoxes.length;
  if (N === 0) return;

  const margin = W * 0.05;
  const gap = W * 0.02;
  const totalGap = gap * (N - 1);
  const boxW = (W - 2 * margin - totalGap) / N;
  const boxH = bottomH * 0.75;
  const boxY = bottomY + (bottomH - boxH) / 2;

  const circledFontSize = Math.min(boxH * 0.35, boxW * 0.35);
  const wordFontSize = Math.min(boxH * 0.22, boxW * 0.18);

  for (let i = 0; i < N; i++) {
    const bx = margin + i * (boxW + gap);
    const wb = wordBoxes[i];

    // Rounded rect background
    ctx.fillStyle = '#f5f5f5';
    ctx.strokeStyle = '#ccc';
    ctx.lineWidth = 1.5;
    roundedRect(bx, boxY, boxW, boxH, Math.min(8, boxH * 0.1));
    ctx.fill();
    ctx.stroke();

    // Question mark
    ctx.fillStyle = '#333';
    ctx.font = circledFontSize + 'px sans-serif';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    const numY = boxY + boxH * 0.35;
    ctx.fillText('?', bx + boxW / 2, numY);

    // Word
    ctx.fillStyle = '#222';
    ctx.font = 'bold ' + wordFontSize + 'px sans-serif';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    const wordY = boxY + boxH * 0.72;
    ctx.fillText(wb.word, bx + boxW / 2, wordY);
  }
}

// Random code
function randCode() {
  const numDigits = ($('code').value || '1234').length;
  const max = Math.pow(10, numDigits);
  $('code').value = (Math.random() * max | 0).toString().padStart(numDigits, '0');
}

// Dice button
document.querySelectorAll('[data-t]').forEach(b => {
  b.onclick = () => {
    if (b.dataset.t === 'code') {
      randCode();
      regenerate();
      draw();
    }
  };
});

// All inputs trigger re-render
$('code').oninput = () => { regenerate(); draw(); };
$('distractors').oninput = () => { regenerate(); draw(); };
$('category').onchange = () => { regenerate(); draw(); };
$('lang').onchange = () => { regenerate(); draw(); };
$('badgeShape').onchange = () => { draw(); };
$('shadow').onchange = () => { draw(); };
$('dotMode').onchange = () => { draw(); };

document.querySelectorAll('input[type=range]').forEach(el => {
  const id = el.id;
  if (id === 'distractors') return; // already handled above
  el.addEventListener('input', () => { regenerate(); draw(); });
});

$('w').oninput = () => { regenerate(); draw(); };
$('h').oninput = () => { regenerate(); draw(); };

// Restore defaults
$('reset').onclick = () => {
  for (const k in DEF) {
    const el = $(k);
    if (!el) continue;
    if (el.type === 'checkbox') {
      el.checked = DEF[k];
    } else {
      el.value = DEF[k];
    }
  }
  document.querySelectorAll('input[type=range]').forEach(r => {
    const span = r.nextElementSibling;
    if (span && span.tagName === 'SPAN') span.textContent = r.value;
  });
  regenerate();
  draw();
};

// Re-render
$('rerender').onclick = () => {
  regenerate();
  draw();
};

// Download on canvas click
$('can').onclick = () => {
  const c = $('code').value || '1234';
  const a = document.createElement('a');
  a.download = NAME + '_' + c + '.png';
  a.href = $('can').toDataURL();
  a.click();
  randCode();
  regenerate();
  draw();
};

// Initial render
regenerate();
draw();
</script>
